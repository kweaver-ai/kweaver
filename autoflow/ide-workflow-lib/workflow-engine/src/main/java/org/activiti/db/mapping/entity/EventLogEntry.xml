<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.activiti.engine.impl.persistence.entity.EvenLogEntryEntity">

  <!-- INSERT -->

  <insert id="insertEventLogEntry" parameterType="org.activiti.engine.impl.persistence.entity.EventLogEntryEntity">
    insert into ${prefix}t_wf_evt_log(type_, proc_def_id_, proc_inst_id_, execution_id_, task_id_, time_stamp_, user_id_, data_, lock_owner_, lock_time_, is_processed_)
    values (
      #{type, jdbcType=VARCHAR}, 
      #{processDefinitionId, jdbcType=VARCHAR}, 
      #{processInstanceId, jdbcType=VARCHAR},
      #{executionId, jdbcType=VARCHAR},
      #{taskId, jdbcType=VARCHAR},   
      #{timeStamp, jdbcType=TIMESTAMP}, 
      #{userId, jdbcType=VARCHAR},
      #{data, jdbcType=BLOB},
      #{lockOwner, jdbcType=VARCHAR},
      #{lockTime, jdbcType=TIMESTAMP},
      #{isProcessed, jdbcType=INTEGER} 
    )  
  </insert>
  
    <insert id="insertEventLogEntry_postgres" parameterType="org.activiti.engine.impl.persistence.entity.EventLogEntryEntity">
    insert into ${prefix}t_wf_evt_log(type_, proc_def_id_, proc_inst_id_, execution_id_, task_id_, time_stamp_, user_id_, data_, lock_owner_, lock_time_, is_processed_)
    values (
      #{type, jdbcType=VARCHAR}, 
      #{processDefinitionId, jdbcType=VARCHAR}, 
      #{processInstanceId, jdbcType=VARCHAR},
      #{executionId, jdbcType=VARCHAR},
      #{taskId, jdbcType=VARCHAR},   
      #{timeStamp, jdbcType=TIMESTAMP}, 
      #{userId, jdbcType=VARCHAR},
      #{data, jdbcType=BINARY},
      #{lockOwner, jdbcType=VARCHAR},
      #{lockTime, jdbcType=TIMESTAMP},
      #{isProcessed, jdbcType=INTEGER} 
    )  
  </insert>

  <insert id="bulkInsertEventLogEntry" parameterType="java.util.List">
    insert into ${prefix}t_wf_evt_log(type_, proc_def_id_, proc_inst_id_, execution_id_, task_id_, time_stamp_, user_id_, data_, lock_owner_, lock_time_, is_processed_)
    values 
      <foreach collection="list" item="eventLogEntry" index="index" separator=",">
        (#{eventLogEntry.type, jdbcType=VARCHAR}, 
         #{eventLogEntry.processDefinitionId, jdbcType=VARCHAR}, 
         #{eventLogEntry.processInstanceId, jdbcType=VARCHAR},
         #{eventLogEntry.executionId, jdbcType=VARCHAR},
         #{eventLogEntry.taskId, jdbcType=VARCHAR},   
         #{eventLogEntry.timeStamp, jdbcType=TIMESTAMP}, 
         #{eventLogEntry.userId, jdbcType=VARCHAR},
         #{eventLogEntry.data, jdbcType=BLOB},
         #{eventLogEntry.lockOwner, jdbcType=VARCHAR},
         #{eventLogEntry.lockTime, jdbcType=TIMESTAMP},
         #{eventLogEntry.isProcessed, jdbcType=INTEGER})
      </foreach>
  </insert>

  <insert id="bulkInsertEventLogEntry_postgres" parameterType="java.util.List">
    insert into ${prefix}T_WF_EVT_LOG(TYPE_, PROC_DEF_ID_, PROC_INST_ID_, EXECUTION_ID_, TASK_ID_, TIME_STAMP_, USER_ID_, DATA_, LOCK_OWNER_, LOCK_TIME_, IS_PROCESSED_)
    values 
      <foreach collection="list" item="eventLogEntry" index="index" separator=",">
        (#{eventLogEntry.type, jdbcType=VARCHAR}, 
         #{eventLogEntry.processDefinitionId, jdbcType=VARCHAR}, 
         #{eventLogEntry.processInstanceId, jdbcType=VARCHAR},
         #{eventLogEntry.executionId, jdbcType=VARCHAR},
         #{eventLogEntry.taskId, jdbcType=VARCHAR},   
         #{eventLogEntry.timeStamp, jdbcType=TIMESTAMP}, 
         #{eventLogEntry.userId, jdbcType=VARCHAR},
         #{eventLogEntry.data, jdbcType=BINARY},
         #{eventLogEntry.lockOwner, jdbcType=VARCHAR},
         #{eventLogEntry.lockTime, jdbcType=TIMESTAMP},
         #{eventLogEntry.isProcessed, jdbcType=INTEGER})
      </foreach>
  </insert>
  
  <insert id="insertEventLogEntry_oracle" parameterType="org.activiti.engine.impl.persistence.entity.EventLogEntryEntity">
    insert into ${prefix}T_WF_EVT_LOG(LOG_NR_, TYPE_, PROC_DEF_ID_, PROC_INST_ID_, EXECUTION_ID_, TASK_ID_, TIME_STAMP_, USER_ID_, DATA_, LOCK_OWNER_, LOCK_TIME_, IS_PROCESSED_)
    values (
      ${prefix}T_WF_EVT_LOG_seq.nextVal,
      #{type, jdbcType=VARCHAR}, 
      #{processDefinitionId, jdbcType=VARCHAR}, 
      #{processInstanceId, jdbcType=VARCHAR},
      #{executionId, jdbcType=VARCHAR},
      #{taskId, jdbcType=VARCHAR},   
      #{timeStamp, jdbcType=TIMESTAMP}, 
      #{userId, jdbcType=VARCHAR},
      #{data, jdbcType=BLOB},
      #{lockOwner, jdbcType=VARCHAR},
      #{lockTime, jdbcType=TIMESTAMP},
      #{isProcessed, jdbcType=INTEGER} 
    )  
  </insert>

  <insert id="bulkInsertEventLogEntry_oracle" parameterType="java.util.List">
    INSERT ALL 
      <foreach collection="list" item="eventLogEntry" index="index">
        into ${prefix}T_WF_EVT_LOG(LOG_NR_, TYPE_, PROC_DEF_ID_, PROC_INST_ID_, EXECUTION_ID_, TASK_ID_,
        TIME_STAMP_, USER_ID_, DATA_, LOCK_OWNER_, LOCK_TIME_, IS_PROCESSED_) VALUES 
            (${prefix}T_WF_EVT_LOG_seq.nextVal,
             #{eventLogEntry.type, jdbcType=VARCHAR}, 
             #{eventLogEntry.processDefinitionId, jdbcType=VARCHAR}, 
             #{eventLogEntry.processInstanceId, jdbcType=VARCHAR},
             #{eventLogEntry.executionId, jdbcType=VARCHAR},
             #{eventLogEntry.taskId, jdbcType=VARCHAR},   
             #{eventLogEntry.timeStamp, jdbcType=TIMESTAMP}, 
             #{eventLogEntry.userId, jdbcType=VARCHAR},
             #{eventLogEntry.data, jdbcType=BLOB},
             #{eventLogEntry.lockOwner, jdbcType=VARCHAR},
             #{eventLogEntry.lockTime, jdbcType=TIMESTAMP},
             #{eventLogEntry.isProcessed, jdbcType=INTEGER})
      </foreach>
    SELECT * FROM dual
  </insert>
  
  <!-- RESULTMAP -->
  
  <resultMap id="eventLogEntryResultMap" type="org.activiti.engine.impl.persistence.entity.EventLogEntryEntity">
    <id property="logNumber" column="log_nr_" jdbcType="BIGINT" />
    <result property="type" column="type_" jdbcType="VARCHAR"/>
    <result property="processDefinitionId" column="proc_def_id_" jdbcType="VARCHAR"/>
    <result property="processInstanceId" column="proc_inst_id_" jdbcType="VARCHAR"/>
    <result property="executionId" column="execution_id_" jdbcType="VARCHAR"/>
    <result property="taskId" column="task_id_" jdbcType="VARCHAR"/>
    <result property="timeStamp" column="time_stamp_" jdbcType="TIMESTAMP"/>
    <result property="userId" column="user_id_" jdbcType="VARCHAR" />
    <result property="data" column="data_" jdbcType="BLOB"/>
    <result property="lockOwner" column="lock_owner_" jdbcType="VARCHAR"/>
    <result property="lockTime" column="lock_time_" jdbcType="TIMESTAMP"/>
    <result property="isProcessed" column="is_processed_" jdbcType="INTEGER"/>
  </resultMap>
  
  <resultMap id="eventLogEntryResultMap_postgres" type="org.activiti.engine.impl.persistence.entity.EventLogEntryEntity">
    <id property="logNumber" column="LOG_NR_" jdbcType="BIGINT" />
    <result property="type" column="TYPE_" jdbcType="VARCHAR"/>
    <result property="processDefinitionId" column="PROC_DEF_ID_" jdbcType="VARCHAR"/>
    <result property="processInstanceId" column="PROC_INST_ID_" jdbcType="VARCHAR"/>
    <result property="executionId" column="EXECUTION_ID_" jdbcType="VARCHAR"/>
    <result property="taskId" column="TASK_ID_" jdbcType="VARCHAR"/>
    <result property="timeStamp" column="TIME_STAMP_" jdbcType="TIMESTAMP"/>
    <result property="userId" column="USER_ID_" jdbcType="VARCHAR" />
    <result property="data" column="DATA_" jdbcType="BINARY"/>
    <result property="lockOwner" column="LOCK_OWNER_" jdbcType="VARCHAR"/>
    <result property="lockTime" column="LOCK_TIME_" jdbcType="TIMESTAMP"/>
    <result property="isProcessed" column="IS_PROCESSED_" jdbcType="INTEGER"/>
  </resultMap>
  
  <!-- SELECTS -->
  
  <select id="selectAllEventLogEntries" resultMap="eventLogEntryResultMap">
    select * from ${prefix}t_wf_evt_log order by log_nr_
  </select>
  
  <select id="selectAllEventLogEntries_postgres" resultMap="eventLogEntryResultMap_postgres">
    select * from ${prefix}t_wf_evt_log order by log_nr_
  </select>
  
  <select id="selectEventLogEntries" parameterType="org.activiti.engine.impl.db.ListQueryParameterObject" resultMap="eventLogEntryResultMap">
    select * from ${prefix}t_wf_evt_log 
    where log_nr_ &gt; #{parameter.startLogNr}
    and log_nr_ &lt; #{parameter.endLogNr}
    order by log_nr_ 
  </select>
  
  <select id="selectEventLogEntries_postgres" parameterType="org.activiti.engine.impl.db.ListQueryParameterObject" resultMap="eventLogEntryResultMap_postgres">
    select * from ${prefix}t_wf_evt_log 
    where log_nr_ &gt; #{parameter.startLogNr}
    and log_nr_ &lt; #{parameter.endLogNr}
    order by log_nr_ 
  </select>
  
  <select id="selectEventLogEntriesByProcessInstanceId" parameterType="org.activiti.engine.impl.db.ListQueryParameterObject" resultMap="eventLogEntryResultMap">
    select * from ${prefix}t_wf_evt_log 
    where proc_inst_id_ = #{parameter.processInstanceId}
    order by log_nr_ 
  </select>
  
  <select id="selectEventLogEntriesByProcessInstanceId_postgres" parameterType="org.activiti.engine.impl.db.ListQueryParameterObject" resultMap="eventLogEntryResultMap_postgres">
    select * from ${prefix}t_wf_evt_log 
    where proc_inst_id_ = #{parameter.processInstanceId}
    order by log_nr_ 
  </select>
  
  <!-- DELETE -->
  <delete id="deleteEventLogEntry" parameterType="long">
    delete from ${prefix}t_wf_evt_log where log_nr_ = #{logNr}
  </delete>

</mapper>