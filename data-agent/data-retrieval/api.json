{
    "openapi": "3.0.3",
    "info": {
        "title": "基础结构化数据分析工具箱2",
        "description": "支持对结构话数据进行处理的工具箱，工具包含: \n1. json2plot\n2. text2sql\n3. text2ngql\n4. text2metric\n5. sql_helper\n6. knowledge_item\n7. jupyter_code_executor\n8. knowledge_rerank\n9. knowledge_retrieval\n10. execute_code\n11. execute_command\n12. read_file\n13. create_file\n14. list_files\n15. get_status\n16. close_sandbox\n17. download_from_efast\n",
        "version": "1.0.11"
    },
    "servers": [
        {
            "url": "http://data-retrieval:9100"
        }
    ],
    "paths": {
        "/tools/json2plot": {
            "post": {
                "summary": "json2plot",
                "description": "根据绘图参数生成用于前端展示的 JSON 对象。如果包含此工具，则优先使用此工具绘图\n\n调用方法是 `json2plot(title, chart_type, group_by, data_field, tool_result_cache_key)`\n\n**注意：**\n- 你拿到结果后, 不需要给用户展示这个 JSON 对象, 前端会自动画图",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "title": {
                                        "type": "string",
                                        "description": "和数据的 title 保持一致, 是一个字符串, **不是dict**"
                                    },
                                    "chart_type": {
                                        "type": "string",
                                        "enum": [
                                            "Pie",
                                            "Line",
                                            "Column"
                                        ],
                                        "description": "图表的类型, 输出仅支持三种: Pie, Line, Column, 环形图也属于 Pie"
                                    },
                                    "group_by": {
                                        "type": "array",
                                        "description": "\n分组字段列表，支持多个字段，如果有时间字段，请放在第一位。另外:\n- 对于折线图, group_by 可能有1~2个值, 第一个是 x 轴, 第二个字段是 分组, data_field 是 y 轴\n- 对于柱状图, group_by 可能有1~3个值, 第一个是 x 轴, 第二个字段是 堆叠, 第三个字段是 分组, data_field 是 y 轴\n- 对于饼图, group_by 只有一个值, 即 colorField, data_field 是 angleField\n",
                                        "items": {
                                            "type": "string"
                                        }
                                    },
                                    "data_field": {
                                        "type": "string",
                                        "description": "数据字段，注意设置的 group_by 和 data_field 必须和数据匹配，不要自己生成，如果数据中没有，可以询问用户"
                                    },
                                    "tool_result_cache_key": {
                                        "type": "string",
                                        "description": "text2metric 或 text2sql工具缓存 key, 其他工具的结果没有意义，key 是一个字符串, 与 data 不能同时设置"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "会话ID"
                                    },
                                    "session_type": {
                                        "type": "string",
                                        "enum": [
                                            "in_memory",
                                            "redis"
                                        ],
                                        "description": "会话类型",
                                        "default": "redis"
                                    },
                                    "data": {
                                        "type": "array",
                                        "description": "图表数据",
                                        "items": {
                                            "type": "object",
                                            "additionalProperties": {
                                                "type": [
                                                    "string",
                                                    "number"
                                                ]
                                            }
                                        }
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 30
                                    }
                                },
                                "required": [
                                    "title",
                                    "chart_type",
                                    "group_by",
                                    "data_field"
                                ],
                                "example": {
                                    "title": "2024年1月1日到2024年1月3日，每天的销售额",
                                    "chart_type": "Line",
                                    "group_by": [
                                        "报告时间(按年)"
                                    ],
                                    "data_field": "营收收入指标",
                                    "tool_result_cache_key": "",
                                    "session_id": "123",
                                    "session_type": "in_memory",
                                    "data": []
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "config": {
                                            "type": "object",
                                            "description": "基础图表配置"
                                        },
                                        "chart_config": {
                                            "type": "object",
                                            "description": "详细图表配置"
                                        },
                                        "title": {
                                            "type": "string",
                                            "description": "图表标题"
                                        },
                                        "result_cache_key": {
                                            "type": "string",
                                            "description": "结果缓存键"
                                        },
                                        "data_sample": {
                                            "type": "array",
                                            "description": "数据样例",
                                            "items": {
                                                "type": "object"
                                            }
                                        }
                                    }
                                },
                                "example": {
                                    "output": {
                                        "config": {
                                            "chart_type": "Column",
                                            "xField": "报告时间(按年)",
                                            "yField": "营收收入指标",
                                            "colorField": "",
                                            "angleField": ""
                                        },
                                        "chart_config": {
                                            "xField": "报告时间(按年)",
                                            "yField": "营收收入指标",
                                            "seriesField": "报告类型",
                                            "chart_type": "Column",
                                            "groupField": ""
                                        },
                                        "title": "2024年1月1日到2024年1月3日，每天的销售额",
                                        "result_cache_key": "CACHE_KEY",
                                        "data_sample": [
                                            {
                                                "报告类型": "一季报",
                                                "报告时间(按年)": "2015",
                                                "营收收入指标": 12312312
                                            }
                                        ]
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/text2sql": {
            "post": {
                "summary": "text2sql",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "description": "根据用户输入的文本和数据视图信息来生成 SQL 语句，并查询数据库。注意: input参数只接受问题，不接受SQL。工具具有更优秀的SQL生成能力，你只需要告诉工具需要查询的内容即可。有时用户只需要生成SQL，不需要查询，需要给出解释\n注意：为了节省 token 数，输出的结果可能不完整，这是正常情况。data_desc 对象来记录返回数据条数和实际结果条数",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "data_source": {
                                        "type": "object",
                                        "description": "视图配置信息",
                                        "properties": {
                                            "view_list": {
                                                "type": "array",
                                                "description": "逻辑视图ID列表",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "base_url": {
                                                "type": "string",
                                                "description": "服务器地址"
                                            },
                                            "token": {
                                                "type": "string",
                                                "description": "认证令牌"
                                            },
                                            "user_id": {
                                                "type": "string",
                                                "description": "用户ID"
                                            },
                                            "visitor_type": {
                                                "type": "string",
                                                "description": "调用者的类型，user 代表普通用户，app 代表应用账号",
                                                "enum": [
                                                    "user",
                                                    "app"
                                                ],
                                                "default": "user"
                                            },
                                            "kg": {
                                                "type": "array",
                                                "description": "知识图谱配置参数，用于从知识图谱中获取数据源",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "kg_id": {
                                                            "type": "string",
                                                            "description": "知识图谱ID"
                                                        },
                                                        "fields": {
                                                            "type": "array",
                                                            "description": "用户选中的实体字段列表",
                                                            "items": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    },
                                                    "required": [
                                                        "kg_id",
                                                        "fields"
                                                    ]
                                                }
                                            },
                                            "kn": {
                                                "type": "array",
                                                "description": "知识网络配置参数",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "knowledge_network_id": {
                                                            "type": "string",
                                                            "description": "知识网络ID"
                                                        },
                                                        "object_types": {
                                                            "type": "array",
                                                            "description": "知识网络对象类型",
                                                            "items": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    },
                                                    "required": [
                                                        "knowledge_network_id"
                                                    ]
                                                }
                                            },
                                            "search_scope": {
                                                "type": "array",
                                                "description": "知识网络搜索范围，支持 object_types, relation_types, action_types",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "recall_mode": {
                                                "type": "string",
                                                "description": "召回模式，支持 keyword_vector_retrieval(默认), agent_intent_planning, agent_intent_retrieval",
                                                "enum": [
                                                    "keyword_vector_retrieval",
                                                    "agent_intent_planning",
                                                    "agent_intent_retrieval"
                                                ],
                                                "default": "keyword_vector_retrieval"
                                            }
                                        },
                                        "required": []
                                    },
                                    "llm": {
                                        "type": "object",
                                        "description": "语言模型配置",
                                        "properties": {
                                            "model_name": {
                                                "type": "string",
                                                "description": "模型名称"
                                            },
                                            "openai_api_key": {
                                                "type": "string",
                                                "description": "OpenAI API密钥"
                                            },
                                            "openai_api_base": {
                                                "type": "string",
                                                "description": "OpenAI API基础URL"
                                            },
                                            "max_tokens": {
                                                "type": "integer",
                                                "description": "最大生成令牌数"
                                            },
                                            "temperature": {
                                                "type": "number",
                                                "description": "生成温度参数"
                                            }
                                        },
                                        "required": []
                                    },
                                    "inner_llm": {
                                        "type": "object",
                                        "description": "内部语言模型配置"
                                    },
                                    "config": {
                                        "type": "object",
                                        "description": "工具配置参数",
                                        "properties": {
                                            "background": {
                                                "type": "string",
                                                "description": "背景信息"
                                            },
                                            "retry_times": {
                                                "type": "integer",
                                                "description": "重试次数",
                                                "default": 3
                                            },
                                            "session_type": {
                                                "type": "string",
                                                "description": "会话类型",
                                                "enum": [
                                                    "in_memory",
                                                    "redis"
                                                ],
                                                "default": "redis"
                                            },
                                            "session_id": {
                                                "type": "string",
                                                "description": "会话ID"
                                            },
                                            "only_essential_dim": {
                                                "type": "boolean",
                                                "description": "是否只展示必要的维度",
                                                "default": true
                                            },
                                            "dimension_num_limit": {
                                                "type": "integer",
                                                "description": "维度数量限制，-1表示不限制, 系统默认为 30",
                                                "default": 30
                                            },
                                            "force_limit": {
                                                "type": "integer",
                                                "description": "返回数据条数限制，-1表示不限制, 默认1000",
                                                "default": 1000
                                            },
                                            "get_desc_from_datasource": {
                                                "type": "boolean",
                                                "description": "是否从数据源获取描述",
                                                "default": true
                                            },
                                            "return_record_limit": {
                                                "type": "integer",
                                                "description": "返回数据条数限制，-1表示不限制",
                                                "default": -1
                                            },
                                            "return_data_limit": {
                                                "type": "integer",
                                                "description": "返回数据总量限制，-1表示不限制",
                                                "default": -1
                                            },
                                            "view_num_limit": {
                                                "type": "integer",
                                                "description": "引用视图数量限制，-1表示不限制",
                                                "default": 5
                                            },
                                            "rewrite_query": {
                                                "type": "boolean",
                                                "description": "是否重写查询",
                                                "default": false
                                            },
                                            "show_sql_graph": {
                                                "type": "boolean",
                                                "description": "是否显示SQL图",
                                                "default": false
                                            }
                                        }
                                    },
                                    "infos": {
                                        "type": "object",
                                        "description": "额外的输入信息, 包含额外信息和知识增强信息",
                                        "properties": {
                                            "knowledge_enhanced_information": {
                                                "type": "object",
                                                "description": "知识增强信息"
                                            },
                                            "extra_info": {
                                                "type": "string",
                                                "description": "额外信息(非知识增强)"
                                            },
                                            "action": {
                                                "type": "string",
                                                "description": "工具行为类型",
                                                "enum": [
                                                    "gen",
                                                    "gen_exec",
                                                    "show_ds"
                                                ],
                                                "default": "gen_exec"
                                            }
                                        }
                                    },
                                    "input": {
                                        "type": "string",
                                        "description": "用户输入的自然语言查询"
                                    },
                                    "action": {
                                        "type": "string",
                                        "description": "工具行为类型",
                                        "enum": [
                                            "gen",
                                            "gen_exec",
                                            "show_ds"
                                        ],
                                        "default": "gen_exec"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    }
                                },
                                "required": [
                                    "data_source",
                                    "input",
                                    "action"
                                ]
                            },
                            "example": {
                                "data_source": {
                                    "view_list": [
                                        "view_id"
                                    ],
                                    "base_url": "https://xxxxx",
                                    "token": "",
                                    "user_id": "",
                                    "kg": [
                                        {
                                            "kg_id": "129",
                                            "fields": [
                                                "regions",
                                                "comments"
                                            ]
                                        }
                                    ],
                                    "kn_id": "",
                                    "search_scope": [
                                        "object_types",
                                        "relation_types",
                                        "action_types"
                                    ],
                                    "recall_mode": "keyword_vector_retrieval"
                                },
                                "llm": {
                                    "model_name": "Model Name",
                                    "openai_api_key": "******",
                                    "openai_api_base": "http://xxxx",
                                    "max_tokens": 4000,
                                    "temperature": 0.1
                                },
                                "inner_llm": {
                                    "frequency_penalty": 0,
                                    "id": "1935601639213895680",
                                    "max_tokens": 1000,
                                    "name": "doubao-seed-1.6-flash",
                                    "presence_penalty": 0,
                                    "temperature": 1,
                                    "top_k": 1,
                                    "top_p": 1
                                },
                                "config": {
                                    "background": "",
                                    "retry_times": 3,
                                    "session_type": "in_memory",
                                    "session_id": "123",
                                    "force_limit": 1000,
                                    "only_essential_dim": true,
                                    "dimension_num_limit": 10,
                                    "get_desc_from_datasource": false,
                                    "return_record_limit": 10,
                                    "return_data_limit": 1000,
                                    "view_num_limit": 5,
                                    "rewrite_query": false,
                                    "show_sql_graph": false,
                                    "recall_mode": "keyword_vector_retrieval"
                                },
                                "infos": {
                                    "knowledge_enhanced_information": {},
                                    "extra_info": "",
                                    "action": "gen_exec"
                                },
                                "input": "去年的业绩",
                                "action": "gen_exec"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "title": {
                                            "type": "string",
                                            "description": "查询标题"
                                        },
                                        "data": {
                                            "type": "array",
                                            "description": "查询结果数据",
                                            "items": {
                                                "type": "object"
                                            }
                                        },
                                        "data_desc": {
                                            "type": "object",
                                            "description": "数据描述信息",
                                            "properties": {
                                                "return_records_num": {
                                                    "type": "integer",
                                                    "description": "返回记录数"
                                                },
                                                "real_records_num": {
                                                    "type": "integer",
                                                    "description": "实际记录数"
                                                }
                                            }
                                        },
                                        "sql": {
                                            "type": "string",
                                            "description": "生成的SQL语句"
                                        },
                                        "explanation": {
                                            "type": "object",
                                            "description": "SQL解释"
                                        },
                                        "cites": {
                                            "type": "array",
                                            "description": "引用的数据视图",
                                            "items": {
                                                "type": "object"
                                            }
                                        },
                                        "result_cache_key": {
                                            "type": "string",
                                            "description": "结果缓存键"
                                        }
                                    }
                                },
                                "example": {
                                    "output": {
                                        "sql": "SELECT ... FROM ... WHERE ... LIMIT 100",
                                        "explanation": {
                                            "XX 视图": [
                                                {
                                                    "指标": "XX 销量"
                                                },
                                                {
                                                    "日期": "XX 日期范围"
                                                },
                                                {
                                                    "品牌": "XX 品牌"
                                                }
                                            ]
                                        },
                                        "cites": [
                                            {
                                                "id": "VIEW_ID",
                                                "name": "XX 视图",
                                                "type": "data_view",
                                                "description": "XX 视图描述"
                                            }
                                        ],
                                        "data": [
                                            {
                                                "日期": "2024-01-01",
                                                "品牌": "XX 品牌",
                                                "销量": 200
                                            }
                                        ],
                                        "title": "XX 标题",
                                        "data_desc": {
                                            "return_records_num": 1,
                                            "real_records_num": 1
                                        },
                                        "result_cache_key": "RESULT_CACHE_KEY"
                                    },
                                    "tokens": "100",
                                    "time": "14.328890085220337"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/text2ngql": {
            "post": {
                "summary": "text2ngql",
                "description": "将问题生成nGQL查询语句，并获取执行结果，复杂问题务必拆分子问题，工具一次只能解决一个子问题",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "query": {
                                        "type": "string",
                                        "description": "自然语言查询语句",
                                        "default": ""
                                    },
                                    "inner_kg": {
                                        "type": "object",
                                        "description": "知识图谱相关配置, 通用引用变量，使用self_config.data_source.kg[0] 获取",
                                        "default": {}
                                    },
                                    "inner_llm": {
                                        "type": "object",
                                        "description": "大语言模型参数配置, 通用选择模型获取",
                                        "default": {}
                                    },
                                    "rewrite_query": {
                                        "type": "string",
                                        "description": "重写后的查询语句，如有，会加入prompt中",
                                        "default": ""
                                    },
                                    "background": {
                                        "type": "string",
                                        "description": "背景信息，如有，会加入prompt中",
                                        "default": ""
                                    },
                                    "retrieval": {
                                        "type": "boolean",
                                        "description": "是否启用检索增强，默认True，会做关键词抽取，向量召回，如果多轮对话时可以使用false，因为之前history带入了schema和检索信息",
                                        "default": true
                                    },
                                    "retrieval_params": {
                                        "type": "object",
                                        "description": "图谱检索相关配置",
                                        "properties": {
                                            "score": {
                                                "type": "number",
                                                "description": "opensearch向量召回阈值",
                                                "default": 0.9
                                            },
                                            "select_num": {
                                                "type": "integer",
                                                "description": "召回数量",
                                                "default": 5
                                            },
                                            "label_name": {
                                                "type": "string",
                                                "description": "选中某个实体类型召回",
                                                "default": "*"
                                            },
                                            "keywords_extract": {
                                                "type": "boolean",
                                                "description": "是否用大模型对问题做关键词抽取",
                                                "default": true
                                            }
                                        },
                                        "default": {
                                            "score": 0.9,
                                            "select_num": 5,
                                            "label_name": "*",
                                            "keywords_extract": true
                                        }
                                    },
                                    "history": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "additionalProperties": true
                                        },
                                        "description": "对话历史记录，多轮对话时需要",
                                        "default": []
                                    },
                                    "cache_cover": {
                                        "type": "boolean",
                                        "description": "是否覆盖缓存，如果True，会重新获取最新的schema或者数据",
                                        "default": false
                                    },
                                    "action": {
                                        "type": "string",
                                        "description": "操作类型，可选值: nl2ngql(自然语言转查询) 或 get_schema(获取schema)或 get_schema(获取schema) 或 keyword_retrieval（获取图谱检索结果）",
                                        "enum": [
                                            "nl2ngql",
                                            "get_schema",
                                            "keyword_retrieval"
                                        ],
                                        "default": "nl2ngql"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    }
                                },
                                "required": [
                                    "inner_kg"
                                ]
                            },
                            "examples": {
                                "图谱查询示例": {
                                    "summary": "查询人物信息示例",
                                    "value": {
                                        "query": "Rose是谁",
                                        "inner_kg": {
                                            "kg_id": "14",
                                            "fields": [
                                                "orgnization",
                                                "person",
                                                "district"
                                            ],
                                            "output_fields": [
                                                "orgnization"
                                            ]
                                        },
                                        "inner_llm": {
                                            "name": "deepseek-v3",
                                            "temperature": 0.01,
                                            "top_k": 2,
                                            "top_p": 0.5,
                                            "frequency_penalty": 0.5,
                                            "max_tokens": 10000,
                                            "presence_penalty": 0.5
                                        },
                                        "background": "",
                                        "rewrite_query": "无",
                                        "retrieval": true,
                                        "cache_cover": false,
                                        "history": [
                                            {
                                                "role": "user",
                                                "content": "图谱存储了爱数公司所有的人和部门信息，当查询爱数总人数时，不需要指定部门名称，直接查询所有人即可。"
                                            }
                                        ]
                                    }
                                },
                                "向量检索示例": {
                                    "summary": "向量检索示例",
                                    "value": {
                                        "query": "Rose是谁",
                                        "inner_kg": {
                                            "kg_id": "5",
                                            "fields": [
                                                "orgnization",
                                                "person",
                                                "district"
                                            ],
                                            "output_fields": [
                                                "orgnization"
                                            ]
                                        },
                                        "inner_llm": {
                                            "name": "ali-deepseek-v3",
                                            "temperature": 0.01,
                                            "top_k": 2,
                                            "top_p": 0.5,
                                            "frequency_penalty": 0.5,
                                            "max_tokens": 10000,
                                            "presence_penalty": 0.5
                                        },
                                        "action": "keyword_retrieval",
                                        "retrieval_params": {
                                            "keywords_extract": false,
                                            "score": 0,
                                            "label_name": "*"
                                        }
                                    }
                                },
                                "获取图谱schema示例": {
                                    "summary": "向量检索示例",
                                    "value": {
                                        "inner_kg": {
                                            "kg_id": "5",
                                            "fields": [
                                                "orgnization",
                                                "person",
                                                "district"
                                            ],
                                            "output_fields": [
                                                "orgnization"
                                            ]
                                        },
                                        "action": "get_schema"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "简化版查询结果",
                                            "properties": {
                                                "sql": {
                                                    "type": "string",
                                                    "description": "生成的nGQL查询语句"
                                                },
                                                "data": {
                                                    "type": "object",
                                                    "description": "查询结果数据"
                                                }
                                            }
                                        },
                                        "full_result": {
                                            "type": "object",
                                            "description": "完整版查询结果",
                                            "properties": {
                                                "sql": {
                                                    "type": "string",
                                                    "description": "生成的nGQL查询语句"
                                                },
                                                "data": {
                                                    "type": "object",
                                                    "description": "查询结果数据"
                                                },
                                                "messages": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object"
                                                    },
                                                    "description": "交互过程中的消息记录"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/text2metric": {
            "post": {
                "summary": "text2metric",
                "description": "根据文本生成指标查询参数, 并查询指标数据",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "data_source": {
                                        "type": "object",
                                        "description": "数据源配置信息",
                                        "properties": {
                                            "metric_list": {
                                                "type": "array",
                                                "description": "指标ID列表",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "base_url": {
                                                "type": "string",
                                                "description": "服务器地址"
                                            },
                                            "token": {
                                                "type": "string",
                                                "description": "认证令牌"
                                            },
                                            "user_id": {
                                                "type": "string",
                                                "description": "用户ID"
                                            },
                                            "visitor_type": {
                                                "type": "string",
                                                "description": "调用者的类型，user 代表普通用户，app 代表应用账号",
                                                "enum": [
                                                    "user",
                                                    "app"
                                                ],
                                                "default": "user"
                                            },
                                            "kn": {
                                                "type": "array",
                                                "description": "知识网络配置参数",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "knowledge_network_id": {
                                                            "type": "string",
                                                            "description": "知识网络ID"
                                                        },
                                                        "object_types": {
                                                            "type": "array",
                                                            "description": "知识网络对象类型",
                                                            "items": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    },
                                                    "required": [
                                                        "knowledge_network_id"
                                                    ]
                                                }
                                            },
                                            "search_scope": {
                                                "type": "array",
                                                "description": "知识网络搜索范围，支持 object_types, relation_types, action_types",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "recall_mode": {
                                                "type": "string",
                                                "description": "召回模式，支持 keyword_vector_retrieval(默认), agent_intent_planning, agent_intent_retrieval",
                                                "enum": [
                                                    "keyword_vector_retrieval",
                                                    "agent_intent_planning",
                                                    "agent_intent_retrieval"
                                                ],
                                                "default": "keyword_vector_retrieval"
                                            }
                                        }
                                    },
                                    "llm": {
                                        "type": "object",
                                        "description": "语言模型配置",
                                        "properties": {
                                            "model_name": {
                                                "type": "string",
                                                "description": "模型名称"
                                            },
                                            "openai_api_key": {
                                                "type": "string",
                                                "description": "OpenAI API密钥"
                                            },
                                            "openai_api_base": {
                                                "type": "string",
                                                "description": "OpenAI API基础URL"
                                            },
                                            "max_tokens": {
                                                "type": "integer",
                                                "description": "最大生成令牌数"
                                            },
                                            "temperature": {
                                                "type": "number",
                                                "description": "生成温度参数"
                                            }
                                        }
                                    },
                                    "inner_llm": {
                                        "type": "object",
                                        "description": "内部语言模型配置"
                                    },
                                    "config": {
                                        "type": "object",
                                        "description": "工具配置参数",
                                        "properties": {
                                            "background": {
                                                "type": "string",
                                                "description": "背景信息"
                                            },
                                            "session_type": {
                                                "type": "string",
                                                "description": "会话类型",
                                                "enum": [
                                                    "in_memory",
                                                    "redis"
                                                ],
                                                "default": "redis"
                                            },
                                            "session_id": {
                                                "type": "string",
                                                "description": "会话ID"
                                            },
                                            "get_desc_from_datasource": {
                                                "type": "boolean",
                                                "description": "是否从数据源获取描述",
                                                "default": true
                                            },
                                            "return_record_limit": {
                                                "type": "integer",
                                                "description": "返回数据条数限制，-1表示不限制, 系统默认为 100",
                                                "default": 100
                                            },
                                            "return_data_limit": {
                                                "type": "integer",
                                                "description": "返回数据总量限制，-1表示不限制, 剩余的数据将通过缓存键获取, 系统默认为 5000",
                                                "default": 5000
                                            },
                                            "force_limit": {
                                                "type": "integer",
                                                "description": "返回数据条数限制，-1表示不限制, 系统默认为 1000",
                                                "default": 1000
                                            }
                                        }
                                    },
                                    "infos": {
                                        "type": "object",
                                        "description": "额外的输入信息, 包含额外信息和知识增强信息",
                                        "properties": {
                                            "knowledge_enhanced_information": {
                                                "type": "object",
                                                "description": "知识增强信息"
                                            },
                                            "extra_info": {
                                                "type": "string",
                                                "description": "额外信息(非知识增强)"
                                            }
                                        }
                                    },
                                    "input": {
                                        "type": "string",
                                        "description": "用户输入的自然语言查询"
                                    },
                                    "action": {
                                        "type": "string",
                                        "description": "操作类型：show_ds 显示数据源信息，query 执行查询（默认）",
                                        "enum": [
                                            "show_ds",
                                            "query"
                                        ],
                                        "default": "query"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    }
                                },
                                "required": [
                                    "data_source",
                                    "input"
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "title": {
                                            "type": "string",
                                            "description": "查询标题"
                                        },
                                        "data": {
                                            "type": "array",
                                            "description": "查询结果数据",
                                            "items": {
                                                "type": "object"
                                            }
                                        },
                                        "data_desc": {
                                            "type": "object",
                                            "description": "数据描述信息",
                                            "properties": {
                                                "return_records_num": {
                                                    "type": "integer",
                                                    "description": "返回记录数"
                                                },
                                                "real_records_num": {
                                                    "type": "integer",
                                                    "description": "实际记录数"
                                                }
                                            }
                                        },
                                        "metric_id": {
                                            "type": "string",
                                            "description": "选择的指标ID"
                                        },
                                        "query_params": {
                                            "type": "object",
                                            "description": "生成的查询参数"
                                        },
                                        "explanation": {
                                            "type": "object",
                                            "description": "查询解释"
                                        },
                                        "cites": {
                                            "type": "array",
                                            "description": "引用的指标",
                                            "items": {
                                                "type": "object"
                                            }
                                        },
                                        "result_cache_key": {
                                            "type": "string",
                                            "description": "结果缓存键"
                                        },
                                        "execution_result": {
                                            "type": "object",
                                            "description": "执行结果"
                                        }
                                    }
                                },
                                "example": {
                                    "output": {
                                        "metric_id": "cpu_usage_metric",
                                        "query_params": {
                                            "instant": false,
                                            "start": 1646360670123,
                                            "end": 1646471470123,
                                            "step": "1m",
                                            "filters": [
                                                {
                                                    "name": "labels.host",
                                                    "value": [
                                                        "server-1",
                                                        "server-2"
                                                    ],
                                                    "operation": "in"
                                                }
                                            ]
                                        },
                                        "explanation": {
                                            "CPU使用率": [
                                                {
                                                    "指标": "使用 'CPU使用率' 指标，按 '时间' '最近1小时' 的数据，并设置过滤条件 '主机为server-1和server-2'"
                                                },
                                                {
                                                    "时间": "从 2024-01-01 到 2024-01-02"
                                                },
                                                {
                                                    "主机": "包含 server-1, server-2"
                                                }
                                            ]
                                        },
                                        "cites": [
                                            {
                                                "id": "cpu_usage_metric",
                                                "name": "CPU使用率",
                                                "type": "metric",
                                                "description": "CPU使用率指标"
                                            }
                                        ],
                                        "data": [
                                            {
                                                "时间": "2024-01-01 10:00:00",
                                                "主机": "server-1",
                                                "CPU使用率": 75.5
                                            },
                                            {
                                                "时间": "2024-01-01 10:01:00",
                                                "主机": "server-1",
                                                "CPU使用率": 78.2
                                            }
                                        ],
                                        "title": "最近1小时CPU使用率",
                                        "data_desc": {
                                            "return_records_num": 2,
                                            "real_records_num": 120
                                        },
                                        "execution_result": {
                                            "success": true,
                                            "model_info": {
                                                "id": "cpu_usage_metric",
                                                "name": "CPU使用率",
                                                "metric_type": "atomic",
                                                "query_type": "dsl",
                                                "unit": "%"
                                            },
                                            "data_summary": {
                                                "total_data_points": 120,
                                                "step": "1m",
                                                "is_variable": false,
                                                "is_calendar": false
                                            },
                                            "sample_data": [
                                                {
                                                    "index": 1,
                                                    "labels": {
                                                        "host": "server-1"
                                                    },
                                                    "time_points": 120,
                                                    "value_points": 120,
                                                    "sample_times": [
                                                        1646360670123,
                                                        1646360730123
                                                    ],
                                                    "sample_values": [
                                                        75.5,
                                                        78.2
                                                    ]
                                                }
                                            ]
                                        },
                                        "result_cache_key": "cpu_usage_metric_1646360670123_1646471470123"
                                    },
                                    "time": "2.5",
                                    "tokens": "150"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/sql_helper": {
            "post": {
                "summary": "sql_helper",
                "description": "专门用于调用 SQL 语句的工具，支持获取元数据信息和执行 SQL 语句。注意：此工具不生成 SQL 语句，只执行已提供的 SQL 语句。",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "data_source": {
                                        "type": "object",
                                        "description": "数据源配置信息",
                                        "properties": {
                                            "view_list": {
                                                "type": "array",
                                                "description": "逻辑视图ID列表",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "base_url": {
                                                "type": "string",
                                                "description": "认证服务URL"
                                            },
                                            "token": {
                                                "type": "string",
                                                "description": "认证令牌，如提供则无需用户名和密码"
                                            },
                                            "user_id": {
                                                "type": "string",
                                                "description": "用户ID"
                                            },
                                            "visitor_type": {
                                                "type": "string",
                                                "description": "调用者的类型，user 代表普通用户，app 代表应用账号",
                                                "enum": [
                                                    "user",
                                                    "app"
                                                ],
                                                "default": "user"
                                            },
                                            "kg": {
                                                "type": "array",
                                                "description": "知识图谱配置参数",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "kg_id": {
                                                            "type": "string",
                                                            "description": "知识图谱ID"
                                                        },
                                                        "fields": {
                                                            "type": "array",
                                                            "description": "用户选中的实体字段列表",
                                                            "items": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    },
                                                    "required": [
                                                        "kg_id",
                                                        "fields"
                                                    ]
                                                }
                                            },
                                            "kn": {
                                                "type": "array",
                                                "description": "知识网络配置参数",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "knowledge_network_id": {
                                                            "type": "string",
                                                            "description": "知识网络ID"
                                                        },
                                                        "object_types": {
                                                            "type": "array",
                                                            "description": "知识网络对象类型",
                                                            "items": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    },
                                                    "required": [
                                                        "knowledge_network_id"
                                                    ]
                                                }
                                            },
                                            "search_scope": {
                                                "type": "array",
                                                "description": "知识网络搜索范围，支持 object_types, relation_types, action_types",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "recall_mode": {
                                                "type": "string",
                                                "description": "召回模式，支持 keyword_vector_retrieval(默认), agent_intent_planning, agent_intent_retrieval",
                                                "enum": [
                                                    "keyword_vector_retrieval",
                                                    "agent_intent_planning",
                                                    "agent_intent_retrieval"
                                                ],
                                                "default": "keyword_vector_retrieval"
                                            }
                                        },
                                        "required": []
                                    },
                                    "config": {
                                        "type": "object",
                                        "description": "工具配置参数",
                                        "properties": {
                                            "session_type": {
                                                "type": "string",
                                                "description": "会话类型",
                                                "enum": [
                                                    "in_memory",
                                                    "redis"
                                                ],
                                                "default": "redis"
                                            },
                                            "session_id": {
                                                "type": "string",
                                                "description": "会话ID"
                                            },
                                            "return_record_limit": {
                                                "type": "integer",
                                                "description": "返回数据条数限制",
                                                "default": 10
                                            },
                                            "return_data_limit": {
                                                "type": "integer",
                                                "description": "返回数据总量限制",
                                                "default": 1000
                                            },
                                            "get_desc_from_datasource": {
                                                "type": "boolean",
                                                "description": "是否从数据源获取工具的描述",
                                                "default": false
                                            },
                                            "with_sample": {
                                                "type": "boolean",
                                                "description": "查询元数据时是否包含样例数据",
                                                "default": true
                                            },
                                            "view_num_limit": {
                                                "type": "integer",
                                                "description": "引用视图数量限制",
                                                "default": 5
                                            },
                                            "dimension_num_limit": {
                                                "type": "integer",
                                                "description": "维度数量限制",
                                                "default": 30
                                            }
                                        }
                                    },
                                    "command": {
                                        "type": "string",
                                        "description": "命令类型: get_metadata(获取元数据信息)、execute_sql(执行 SQL 语句)",
                                        "enum": [
                                            "get_metadata",
                                            "execute_sql"
                                        ],
                                        "default": "execute_sql"
                                    },
                                    "sql": {
                                        "type": "string",
                                        "description": "SQL语句"
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "数据的标题，获取元数据则必填"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "with_sample": {
                                        "type": "boolean",
                                        "description": "查询元数据时是否包含样例数据",
                                        "default": true
                                    }
                                },
                                "required": [
                                    "data_source",
                                    "command"
                                ]
                            },
                            "example": {
                                "data_source": {
                                    "view_list": [
                                        "view_id"
                                    ],
                                    "base_url": "https://xxxxx",
                                    "token": "",
                                    "user_id": "",
                                    "visitor_type": "user",
                                    "kn": [
                                        {
                                            "knowledge_network_id": "129",
                                            "object_types": [
                                                "data_view",
                                                "metric"
                                            ]
                                        }
                                    ],
                                    "search_scope": [
                                        "object_types",
                                        "relation_types",
                                        "action_types"
                                    ],
                                    "recall_mode": "keyword_vector_retrieval"
                                },
                                "config": {
                                    "session_type": "redis",
                                    "session_id": "123",
                                    "return_record_limit": 10,
                                    "return_data_limit": 1000,
                                    "get_desc_from_datasource": false,
                                    "with_sample": true,
                                    "view_num_limit": 5,
                                    "dimension_num_limit": 30
                                },
                                "command": "execute_sql",
                                "sql": "SELECT * FROM table LIMIT 10",
                                "title": "数据的标题",
                                "timeout": 120
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "command": {
                                            "type": "string",
                                            "description": "执行的命令类型"
                                        },
                                        "sql": {
                                            "type": "string",
                                            "description": "执行的SQL语句"
                                        },
                                        "data": {
                                            "type": "array",
                                            "description": "查询结果数据",
                                            "items": {
                                                "type": "object"
                                            }
                                        },
                                        "data_desc": {
                                            "type": "object",
                                            "description": "数据描述信息",
                                            "properties": {
                                                "return_records_num": {
                                                    "type": "integer",
                                                    "description": "返回记录数"
                                                },
                                                "real_records_num": {
                                                    "type": "integer",
                                                    "description": "实际记录数"
                                                }
                                            }
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "执行结果消息"
                                        },
                                        "result_cache_key": {
                                            "type": "string",
                                            "description": "结果缓存键"
                                        }
                                    }
                                },
                                "example": {
                                    "output": {
                                        "command": "execute_sql",
                                        "sql": "SELECT * FROM table LIMIT 10",
                                        "data": [
                                            {
                                                "column1": "value1",
                                                "column2": "value2"
                                            }
                                        ],
                                        "data_desc": {
                                            "return_records_num": 1,
                                            "real_records_num": 1
                                        },
                                        "message": "SQL 执行成功",
                                        "result_cache_key": "RESULT_CACHE_KEY"
                                    },
                                    "tokens": "100",
                                    "time": "14.328890085220337"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/knowledge_item": {
            "post": {
                "summary": "knowledge_item",
                "description": "根据输入的文本，获取知识条目信息，知识条目可用于为其他工具提供背景知识",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "data_source": {
                                        "type": "object",
                                        "description": "数据源配置信息",
                                        "properties": {
                                            "data_item_ids": {
                                                "type": "array",
                                                "description": "知识条目ID列表",
                                                "items": {
                                                    "type": "string"
                                                }
                                            },
                                            "base_url": {
                                                "type": "string",
                                                "description": "服务器地址"
                                            },
                                            "token": {
                                                "type": "string",
                                                "description": "认证令牌"
                                            },
                                            "user_id": {
                                                "type": "string",
                                                "description": "用户ID"
                                            }
                                        },
                                        "required": [
                                            "data_item_ids"
                                        ]
                                    },
                                    "input": {
                                        "type": "string",
                                        "description": "用户需要查询的文本"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 30
                                    },
                                    "config": {
                                        "type": "object",
                                        "description": "工具配置参数",
                                        "properties": {
                                            "return_record_limit": {
                                                "type": "integer",
                                                "description": "每个知识条目返回数据条数限制，-1 代表不限制",
                                                "default": 30
                                            },
                                            "return_data_limit": {
                                                "type": "integer",
                                                "description": "每个知识条目返回数据总量限制，-1 代表不限制",
                                                "default": -1
                                            },
                                            "knowledge_item_limit": {
                                                "type": "integer",
                                                "description": "知识条目个数限制，-1 代表不限制，默认 5",
                                                "default": 5
                                            }
                                        }
                                    }
                                },
                                "required": [
                                    "data_source"
                                ]
                            },
                            "example": {
                                "data_source": {
                                    "data_item_ids": [
                                        "data_item_id"
                                    ],
                                    "base_url": "https://xxxxx",
                                    "token": "",
                                    "user_id": ""
                                },
                                "input": "用户需要查询的文本"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "output": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "name": {
                                                        "type": "string",
                                                        "description": "知识条目名称"
                                                    },
                                                    "comment": {
                                                        "type": "string",
                                                        "description": "知识条目描述"
                                                    },
                                                    "type": {
                                                        "type": "string",
                                                        "description": "知识条目类型"
                                                    },
                                                    "items": {
                                                        "oneOf": [
                                                            {
                                                                "type": "object",
                                                                "description": "键值对类型知识条目",
                                                                "additionalProperties": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            {
                                                                "type": "array",
                                                                "description": "列表类型知识条目",
                                                                "items": {
                                                                    "type": "object",
                                                                    "properties": {
                                                                        "key": {
                                                                            "type": "string",
                                                                            "description": "知识条目键"
                                                                        },
                                                                        "value": {
                                                                            "type": "string",
                                                                            "description": "知识条目值"
                                                                        },
                                                                        "comment": {
                                                                            "type": "string",
                                                                            "description": "知识条目描述"
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    },
                                                    "data_summary": {
                                                        "type": "object",
                                                        "properties": {
                                                            "return_data_num": {
                                                                "type": "integer",
                                                                "description": "返回数据条数"
                                                            },
                                                            "real_data_num": {
                                                                "type": "integer",
                                                                "description": "实际数据条数"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                "example": {
                                    "output": [
                                        {
                                            "name": "知识条目名称",
                                            "comment": "知识条目描述",
                                            "type": "kv_dict",
                                            "items": {
                                                "key1": "value1",
                                                "key2": "value2"
                                            },
                                            "data_summary": {
                                                "return_data_num": 2,
                                                "real_data_num": 10
                                            }
                                        },
                                        {
                                            "name": "列表类型知识条目",
                                            "comment": "知识条目描述",
                                            "type": "list",
                                            "items": [
                                                {
                                                    "key": "知识条目名称",
                                                    "value": "知识条目值",
                                                    "comment": "知识条目描述"
                                                }
                                            ],
                                            "data_summary": {
                                                "return_data_num": 1,
                                                "real_data_num": 5
                                            }
                                        }
                                    ],
                                    "tokens": "100",
                                    "time": "14.328890085220337"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/jupyter_code_executor": {
            "post": {
                "summary": "执行Python代码",
                "description": "在Jupyter内核中执行Python代码，支持会话保持变量池",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "code": {
                                        "type": "string",
                                        "description": "要执行的Python代码"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "会话ID，用于保持变量池的一致性"
                                    }
                                },
                                "required": [
                                    "code",
                                    "session_id"
                                ]
                            },
                            "examples": {
                                "简单计算": {
                                    "summary": "简单计算示例",
                                    "value": {
                                        "code": "a = 10\nb = 20\nresult = a + b\nresult",
                                        "session_id": "session_123"
                                    }
                                },
                                "变量保持": {
                                    "summary": "变量保持示例",
                                    "value": {
                                        "code": "print(f'a的值是: {a}')",
                                        "session_id": "session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful response",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "执行结果"
                                        },
                                        "full_result": {
                                            "type": "object",
                                            "description": "完整执行结果"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/knowledge_rerank": {
            "post": {
                "summary": "rerank_tool",
                "description": "概念重排序工具，根据查询意图对概念列表进行重排序",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "query_understanding": {
                                        "type": "object",
                                        "description": "查询理解结果",
                                        "properties": {
                                            "origin_query": {
                                                "type": "string",
                                                "description": "原始查询文本"
                                            },
                                            "processed_query": {
                                                "type": "string",
                                                "description": "处理后的查询文本"
                                            },
                                            "intent": {
                                                "type": "array",
                                                "description": "意图列表",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "type": {
                                                            "type": "string"
                                                        },
                                                        "description": {
                                                            "type": "string"
                                                        },
                                                        "confidence": {
                                                            "type": "number"
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "required": [
                                            "origin_query"
                                        ]
                                    },
                                    "concepts": {
                                        "type": "array",
                                        "description": "需要重排序的概念列表",
                                        "items": {
                                            "type": "object"
                                        }
                                    },
                                    "action": {
                                        "type": "string",
                                        "description": "重排序方法",
                                        "enum": [
                                            "llm",
                                            "vector"
                                        ],
                                        "default": "llm"
                                    },
                                    "batch_size": {
                                        "type": "integer",
                                        "description": "批处理大小",
                                        "default": 128
                                    }
                                },
                                "required": [
                                    "query_understanding",
                                    "concepts"
                                ]
                            },
                            "example": {
                                "query_understanding": {
                                    "origin_query": "分析销售数据中的趋势",
                                    "processed_query": "分析销售数据中的趋势",
                                    "intent": [
                                        {
                                            "type": "analysis",
                                            "description": "数据分析意图",
                                            "confidence": 0.9
                                        }
                                    ]
                                },
                                "concepts": [
                                    {
                                        "id": "concept_1",
                                        "name": "销售额",
                                        "description": "产品的销售金额",
                                        "type": "metric",
                                        "properties": {}
                                    }
                                ],
                                "action": "llm",
                                "batch_size": 128
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "description": "重排序后的概念列表",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "type": "string"
                                            },
                                            "name": {
                                                "type": "string"
                                            },
                                            "description": {
                                                "type": "string"
                                            },
                                            "type": {
                                                "type": "string"
                                            },
                                            "properties": {
                                                "type": "object"
                                            },
                                            "rerank_score": {
                                                "type": "number"
                                            }
                                        }
                                    }
                                },
                                "example": [
                                    {
                                        "id": "concept_1",
                                        "name": "销售额",
                                        "description": "产品的销售金额",
                                        "type": "metric",
                                        "properties": {},
                                        "rerank_score": 0.95
                                    }
                                ]
                            }
                        }
                    }
                }
            }
        },
        "/tools/knowledge_retrieval": {
            "post": {
                "summary": "知识网络检索工具",
                "description": "基于知识网络的智能检索工具，能够根据用户问题检索相关的知识网络、对象类型和关系类型",
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "query": {
                                        "type": "string",
                                        "description": "用户查询问题"
                                    },
                                    "top_k": {
                                        "type": "integer",
                                        "description": "返回最相关的概念类型数量",
                                        "default": 10
                                    },
                                    "kn_id": {
                                        "type": "string",
                                        "description": "指定的知识网络ID，如果不传则检索所有知识网络",
                                        "nullable": true
                                    },
                                    "headers": {
                                        "type": "object",
                                        "description": "HTTP请求头",
                                        "nullable": true
                                    }
                                },
                                "required": [
                                    "query"
                                ]
                            },
                            "example": {
                                "query": "查询化工企业使用的催化剂信息",
                                "top_k": 10
                            }
                        }
                    }
                },
                "parameters": [
                    {
                        "name": "x-user",
                        "in": "header",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "用户标识符"
                    },
                    {
                        "name": "Content-Type",
                        "in": "header",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "default": "application/json"
                        },
                        "description": "内容类型"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "answer": {
                                            "type": "array",
                                            "description": "检索结果",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "concept_type": {
                                                        "type": "string",
                                                        "description": "概念类型: object_type 或 relation_type"
                                                    },
                                                    "concept_id": {
                                                        "type": "string",
                                                        "description": "概念ID"
                                                    },
                                                    "concept_name": {
                                                        "type": "string",
                                                        "description": "概念名称"
                                                    },
                                                    "source_object_type_id": {
                                                        "type": "string",
                                                        "description": "源对象类型ID（仅关系类型有）",
                                                        "nullable": true
                                                    },
                                                    "target_object_type_id": {
                                                        "type": "string",
                                                        "description": "目标对象类型ID（仅关系类型有）",
                                                        "nullable": true
                                                    }
                                                },
                                                "required": [
                                                    "concept_type",
                                                    "concept_id",
                                                    "concept_name"
                                                ]
                                            }
                                        },
                                        "time": {
                                            "type": "number",
                                            "description": "执行时间"
                                        }
                                    },
                                    "required": [
                                        "answer",
                                        "time"
                                    ]
                                },
                                "example": {
                                    "answer": [
                                        {
                                            "concept_type": "object_type",
                                            "concept_id": "chemical",
                                            "concept_name": "物质物料",
                                            "source_object_type_id": null,
                                            "target_object_type_id": null
                                        },
                                        {
                                            "concept_type": "object_type",
                                            "concept_id": "catalyzer",
                                            "concept_name": "催化剂",
                                            "source_object_type_id": null,
                                            "target_object_type_id": null
                                        },
                                        {
                                            "concept_type": "relation_type",
                                            "concept_id": "chemical_2_catalyzer",
                                            "concept_name": "可作为催化剂",
                                            "source_object_type_id": "chemical",
                                            "target_object_type_id": "catalyzer"
                                        }
                                    ],
                                    "time": 1.23
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/execute_code": {
            "post": {
                "summary": "execute_code",
                "description": "在沙箱环境中执行 Python 代码，支持 pandas 等数据分析库，注意沙箱环境是受限环境，没有网络连接，不能使用 pip 安装第三方库。运行代码时，需要通过 print 输出结果，或者设置输出变量 output_params 参数，返回结果",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    },
                                    "content": {
                                        "type": "string",
                                        "description": "要执行的 Python 代码内容"
                                    },
                                    "filename": {
                                        "type": "string",
                                        "description": "文件名，用于指定代码文件的名称"
                                    },
                                    "args": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "代码执行参数"
                                    },
                                    "output_params": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "输出参数列表，用于指定要返回的变量名"
                                    }
                                },
                                "required": [
                                    "content"
                                ]
                            },
                            "examples": {
                                "basic_execution": {
                                    "summary": "基础代码执行",
                                    "description": "执行简单的 Python 代码",
                                    "value": {
                                        "content": "print('Hello World')\nx = 10\ny = 20\nresult = x + y\nprint(f'{x} + {y} = {result}')",
                                        "filename": "hello.py",
                                        "output_params": [
                                            "result"
                                        ],
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                },
                                "data_analysis": {
                                    "summary": "数据分析示例",
                                    "description": "使用 pandas 进行数据分析",
                                    "value": {
                                        "content": "import pandas as pd\nimport numpy as np\n\n# 创建示例数据\ndata = {\n    'name': ['Alice', 'Bob', 'Charlie'],\n    'age': [25, 30, 35],\n    'salary': [50000, 60000, 70000]\n}\ndf = pd.DataFrame(data)\n\n# 计算统计信息\nstats = {\n    'mean_age': df['age'].mean(),\n    'mean_salary': df['salary'].mean(),\n    'total_records': len(df)\n}\n\nprint('数据统计:')\nfor key, value in stats.items():\n    print(f'{key}: {value}')\n\nresult = stats",
                                        "filename": "data_analysis.py",
                                        "output_params": [
                                            "result",
                                            "df"
                                        ],
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/execute_command": {
            "post": {
                "summary": "execute_command",
                "description": "在沙箱环境中执行系统命令，如 ls、cat、grep 等 Linux 命令",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    },
                                    "command": {
                                        "type": "string",
                                        "description": "要执行的系统命令"
                                    },
                                    "args": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "命令参数列表"
                                    }
                                },
                                "required": [
                                    "command"
                                ]
                            },
                            "examples": {
                                "list_files": {
                                    "summary": "列出文件",
                                    "description": "列出当前目录下的所有文件",
                                    "value": {
                                        "command": "ls",
                                        "args": [
                                            "-la"
                                        ],
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                },
                                "view_file": {
                                    "summary": "查看文件内容",
                                    "description": "查看指定文件的内容",
                                    "value": {
                                        "command": "cat",
                                        "args": [
                                            "hello.py"
                                        ],
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                },
                                "search_content": {
                                    "summary": "搜索内容",
                                    "description": "在文件中搜索指定内容",
                                    "value": {
                                        "command": "grep",
                                        "args": [
                                            "-n",
                                            "print",
                                            "*.py"
                                        ],
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/read_file": {
            "post": {
                "summary": "read_file",
                "description": "读取沙箱环境中的文件内容，支持文本文件和二进制文件",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    },
                                    "filename": {
                                        "type": "string",
                                        "description": "要读取的文件名"
                                    },
                                    "session_type": {
                                        "type": "string",
                                        "description": "会话类型, 可选值为: redis, in_memory, 默认值为 redis"
                                    }
                                },
                                "required": [
                                    "filename"
                                ]
                            },
                            "examples": {
                                "read_python_file": {
                                    "summary": "读取 Python 文件",
                                    "description": "读取 Python 源代码文件",
                                    "value": {
                                        "filename": "hello.py",
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/create_file": {
            "post": {
                "summary": "create_file",
                "description": "在沙箱环境中创建新文件，支持文本内容或从缓存中获取内容",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    },
                                    "content": {
                                        "type": "string",
                                        "description": "文件内容, 如果 result_cache_key 参数不为空，则无需设置该参数"
                                    },
                                    "filename": {
                                        "type": "string",
                                        "description": "要创建的文件名"
                                    },
                                    "session_type": {
                                        "type": "string",
                                        "description": "会话类型, 可选值为: redis, in_memory, 默认值为 redis"
                                    },
                                    "result_cache_key": {
                                        "type": "string",
                                        "description": "之前工具的结果缓存key，可以用于将结果写入到文件中，有此参数则无需设置 content 参数"
                                    }
                                },
                                "required": [
                                    "filename"
                                ]
                            },
                            "examples": {
                                "create_python_file": {
                                    "summary": "创建 Python 文件",
                                    "description": "创建包含 Python 代码的文件",
                                    "value": {
                                        "content": "def fibonacci(n):\n    if n <= 1:\n        return n\n    return fibonacci(n-1) + fibonacci(n-2)\n\n# 计算前10个斐波那契数\nfor i in range(10):\n    print(f'F({i}) = {fibonacci(i)}')",
                                        "filename": "fibonacci.py",
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                },
                                "create_from_cache": {
                                    "summary": "从缓存创建文件",
                                    "description": "使用缓存中的数据创建文件",
                                    "value": {
                                        "filename": "data.json",
                                        "result_cache_key": "cached_data_123",
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/list_files": {
            "post": {
                "summary": "list_files",
                "description": "列出沙箱环境中的所有文件和目录",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    }
                                },
                                "required": []
                            },
                            "examples": {
                                "list_all_files": {
                                    "summary": "列出所有文件",
                                    "description": "列出沙箱环境中的所有文件和目录",
                                    "value": {
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/get_status": {
            "post": {
                "summary": "get_status",
                "description": "获取沙箱环境的当前状态信息",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    }
                                },
                                "required": []
                            },
                            "examples": {
                                "get_sandbox_status": {
                                    "summary": "获取沙箱状态",
                                    "description": "获取沙箱环境的当前状态信息",
                                    "value": {
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/close_sandbox": {
            "post": {
                "summary": "close_sandbox",
                "description": "清理沙箱工作区，关闭沙箱连接",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "number",
                                        "description": "超时时间",
                                        "default": 120
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    }
                                },
                                "required": []
                            },
                            "examples": {
                                "close_sandbox": {
                                    "summary": "清理工作区",
                                    "description": "清理沙箱工作区，关闭沙箱连接",
                                    "value": {
                                        "server_url": "http://localhost:8080",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/tools/download_from_efast": {
            "post": {
                "summary": "download_from_efast",
                "description": "从文档库(EFAST)下载文件到沙箱环境，支持批量下载多个文件。需要提供文件参数列表，格式为[{'id': '...', 'type': 'doc', 'name': '...', 'details': {'docid': 'gns://...', 'size': ...}}]",
                "parameters": [
                    {
                        "name": "stream",
                        "in": "query",
                        "description": "是否流式返回",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    },
                    {
                        "name": "mode",
                        "in": "query",
                        "description": "请求模式",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "http",
                                "sse"
                            ],
                            "default": "http"
                        }
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "server_url": {
                                        "type": "string",
                                        "description": "可选，沙箱服务器URL，默认使用配置文件中的 SANDBOX_URL",
                                        "default": "http://sandbox-env:9101"
                                    },
                                    "session_id": {
                                        "type": "string",
                                        "description": "沙箱会话ID"
                                    },
                                    "timeout": {
                                        "type": "integer",
                                        "description": "超时时间(秒)，可选，默认300秒",
                                        "default": 300
                                    },
                                    "title": {
                                        "type": "string",
                                        "description": "对于当前操作的简单描述，便于用户理解"
                                    },
                                    "file_params": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "properties": {
                                                "id": {
                                                    "type": "string",
                                                    "description": "文档ID"
                                                },
                                                "type": {
                                                    "type": "string",
                                                    "description": "文档类型"
                                                },
                                                "name": {
                                                    "type": "string",
                                                    "description": "文档名称"
                                                },
                                                "details": {
                                                    "type": "object",
                                                    "properties": {
                                                        "docid": {
                                                            "type": "string",
                                                            "description": "完整的文档ID"
                                                        },
                                                        "size": {
                                                            "type": "integer",
                                                            "description": "文件大小"
                                                        }
                                                    },
                                                    "required": [
                                                        "docid"
                                                    ]
                                                }
                                            },
                                            "required": [
                                                "details"
                                            ]
                                        },
                                        "description": "下载文件参数列表"
                                    },
                                    "save_path": {
                                        "type": "string",
                                        "description": "保存路径，可选，默认保存到会话目录"
                                    },
                                    "efast_url": {
                                        "type": "string",
                                        "description": "EFAST地址，可选，默认使用默认URL"
                                    },
                                    "token": {
                                        "type": "string",
                                        "description": "认证令牌"
                                    }
                                },
                                "required": [
                                    "file_params"
                                ]
                            },
                            "examples": {
                                "single_file": {
                                    "summary": "下载单个文件",
                                    "description": "从文档库(EFAST)下载单个文件",
                                    "value": {
                                        "file_params": [
                                            {
                                                "id": "5CB5AA515EBD4CB785918D43982FCE42",
                                                "type": "doc",
                                                "name": "新能源汽车产业分析 (10).docx",
                                                "details": {
                                                    "docid": "gns://00328E97423F42AC9DEE87B4F4B4631E/83D893844A0B4A34A64DFFB343BEF416/5CB5AA515EBD4CB785918D43982FCE42",
                                                    "size": 15635
                                                }
                                            }
                                        ],
                                        "save_path": "",
                                        "efast_url": "https://efast.example.com",
                                        "timeout": 300,
                                        "token": "1234567890",
                                        "server_url": "",
                                        "session_id": "test_session_123"
                                    }
                                },
                                "multiple_files": {
                                    "summary": "批量下载文件",
                                    "description": "从文档库(EFAST)批量下载多个文件",
                                    "value": {
                                        "file_params": [
                                            {
                                                "id": "5CB5AA515EBD4CB785918D43982FCE42",
                                                "type": "doc",
                                                "name": "新能源汽车产业分析 (10).docx",
                                                "details": {
                                                    "docid": "gns://00328E97423F42AC9DEE87B4F4B4631E/83D893844A0B4A34A64DFFB343BEF416/5CB5AA515EBD4CB785918D43982FCE42",
                                                    "size": 15635
                                                }
                                            },
                                            {
                                                "id": "6CB5AA515EBD4CB785918D43982FCE43",
                                                "type": "doc",
                                                "name": "市场分析报告.pdf",
                                                "details": {
                                                    "docid": "gns://00328E97423F42AC9DEE87B4F4B4631E/83D893844A0B4A34A64DFFB343BEF416/6CB5AA515EBD4CB785918D43982FCE43",
                                                    "size": 24567
                                                }
                                            }
                                        ],
                                        "save_path": "",
                                        "timeout": 600,
                                        "token": "1234567890",
                                        "server_url": "",
                                        "session_id": "test_session_123"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "result": {
                                            "type": "object",
                                            "description": "操作结果, 包含标准输出、标准错误输出、返回值"
                                        },
                                        "message": {
                                            "type": "string",
                                            "description": "操作状态消息"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "error": {
                                            "type": "string",
                                            "description": "错误信息"
                                        },
                                        "detail": {
                                            "type": "string",
                                            "description": "详细错误信息"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}